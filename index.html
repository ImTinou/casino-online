<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎰 SIO Casino - Blackjack Royal 🎰</title>
    <!-- Firebase SDK v9 Compat -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.2/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.22.2/firebase-database-compat.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Particules d'ambiance -->
    <div class="particles" id="particles"></div>

    <!-- Lobby Screen -->
    <div id="lobby" class="lobby">
        <div class="casino-logo">🎰 SIO CASINO 🎰</div>
        <div class="lobby-card">
            <h2>🃏 Table de Blackjack Exclusive</h2>
            <p style="margin: 20px 0; opacity: 0.9;">Rejoignez la plus prestigieuse table de blackjack en ligne. Maximum 5 joueurs par partie.</p>
            
            <div class="input-group">
                <label for="playerName">👤 Votre nom de joueur :</label>
                <input type="text" id="playerName" placeholder="Entrez votre nom..." maxlength="12">
            </div>

            <div style="display: flex; gap: 20px; justify-content: center; margin-top: 30px; flex-wrap: wrap;">
                <button class="btn btn-gold" onclick="createRoom()">
                    🎯 Ouvrir une table (Croupier)
                </button>
                <button class="btn btn-primary" onclick="showJoinRoom()">
                    🎲 Rejoindre une table
                </button>
            </div>
        </div>

        <div id="joinRoomCard" class="lobby-card" style="display: none;">
            <h3>🎫 Rejoindre une table</h3>
            <div class="input-group">
                <label for="roomCode">Code de la table :</label>
                <input type="text" id="roomCode" placeholder="Code à 6 lettres..." maxlength="6" style="text-transform: uppercase;">
            </div>
            <button class="btn btn-success" onclick="joinRoom()">Entrer à la table</button>
            <button class="btn" onclick="hideJoinRoom()">Annuler</button>
        </div>
    </div>

    <!-- Game Interface -->
    <div id="gameInterface" class="game-interface">
        <div class="container">
            <div class="game-header">
                <div class="room-info">
                    <div class="connection-status">
                        <div class="status-dot connected" id="connectionDot"></div>
                        <span id="connectionStatus">Connecté</span>
                    </div>
                    <div class="room-code-display" id="gameRoomCode">ABC123</div>
                    <div style="color: #FFD700;">
                        <span id="playerCount">1</span>/5 joueurs
                    </div>
                </div>
                <div>
                    <button class="btn btn-danger" onclick="leaveGame()">🚪 Quitter</button>
                </div>
            </div>

            <!-- Table de Casino améliorée -->
            <div class="casino-table">
                <div class="table-felt"></div>
                <div class="table-shine"></div>
                
                <!-- Position du croupier -->
                <div class="dealer-position">
                    <div class="dealer-avatar">🎩</div>
                    <div class="player-name">Croupier</div>
                    <div class="player-score" id="dealerScore">--</div>
                    <div id="dealerCards" class="cards-area"></div>
                </div>

                <!-- Paquet de cartes -->
                <div class="deck-position">
                    <div class="deck-stack" id="deckStack">
                        <div class="deck-card">🂠</div>
                        <div class="deck-card">🂠</div>
                        <div class="deck-card">🂠</div>
                        <div class="deck-card">🂠</div>
                        <div class="deck-card">🂠</div>
                    </div>
                </div>

                <!-- Positions des joueurs optimisées -->
                <div class="player-positions" id="playerPositions">
                    <!-- Les positions seront générées dynamiquement -->
                </div>
            </div>

            <!-- Timer global -->
            <div id="playerTimer" class="player-timer" style="display: none;">
                <div class="timer-bar">
                    <div class="timer-fill" id="timerFill"></div>
                </div>
                <div class="timer-text">⏰ <span id="timerText">30</span>s</div>
            </div>

            <!-- Chat Box -->
            <div id="chatBox" class="chat-box">
                <div id="chatMessages" class="chat-messages"></div>
                <form id="chatForm" class="chat-form">
                    <input id="chatInput" type="text" maxlength="120" placeholder="Message..." class="chat-input">
                    <button type="submit" class="btn btn-gold">📤</button>
                </form>
            </div>

            <!-- Contrôles de jeu -->
            <div class="game-controls">
                <div id="dealerControls" style="display: none;">
                    <button class="btn btn-gold" onclick="startNewHand()">🎴 Distribuer</button>
                    <button class="btn btn-warning" onclick="dealerPlay()" id="dealerPlayBtn" style="display: none;">🎲 Tour croupier</button>
                </div>
                
                <div id="playerControls" style="display: none;">
                    <button class="btn btn-success" onclick="hit()">⬆️ Carte</button>
                    <button class="btn btn-danger" onclick="stand()">✋ Rester</button>
                    <button class="btn btn-warning" id="playerDoubleBtn" onclick="doubleDown()" style="display:none;">💰 Doubler</button>
                    <button class="btn btn-gold" id="playerSplitBtn" onclick="splitHand()" style="display:none;">🃏 Split</button>
                </div>
                
                <div id="waitingControls" style="display: none;">
                    <div style="text-align: center; color: #FFD700;">
                        <div class="loading"></div>
                        <p style="margin-top: 10px;">En attente...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts modulaires -->
    <script src="firebase-manager.js"></script>
    <script src="game-logic.js"></script>
    <script src="ui-manager.js"></script>
    <script src="main.js"></script>
</body>
</html>